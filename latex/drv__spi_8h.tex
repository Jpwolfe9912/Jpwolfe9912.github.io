\hypertarget{drv__spi_8h}{}\doxysection{/\+Users/jeremywolfe/\+Documents/\+STM32\+Cube\+IDE/\+Autodrone32/\+Src/drv/drv\+\_\+spi.h File Reference}
\label{drv__spi_8h}\index{/Users/jeremywolfe/Documents/STM32CubeIDE/Autodrone32/Src/drv/drv\_spi.h@{/Users/jeremywolfe/Documents/STM32CubeIDE/Autodrone32/Src/drv/drv\_spi.h}}


This file initializes the SPI peripheral as well as writes and reads to another device over SPI.  


\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{drv__spi_8h_a969f555816dfb8f48a85c1795ff5e63d}{SPI1\+\_\+\+ENABLE}}~GPIOA-\/$>$BSRR $\vert$= GPIO\+\_\+\+BSRR\+\_\+\+BR4
\item 
\#define \mbox{\hyperlink{drv__spi_8h_af64f6dca6126f4fb9299c912c7f8ad81}{SPI1\+\_\+\+DISABLE}}~GPIOA-\/$>$BSRR $\vert$= GPIO\+\_\+\+BSRR\+\_\+\+BS4
\item 
\#define \mbox{\hyperlink{drv__spi_8h_ad0b1b31708f069aa075fe2f2b899babf}{SPI\+\_\+\+BR\+\_\+\+PRESCALER\+\_\+16}}~(0x3 $<$$<$ 3U)
\item 
\#define \mbox{\hyperlink{drv__spi_8h_a1e6f0af65653e4941210f2ebf6e96df6}{SPI\+\_\+\+BR\+\_\+\+PRESCALER\+\_\+128}}~(0x6 $<$$<$ 3U)
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{drv__spi_8h_afdbacf07d926a145cc4d681c38980d03}{spi1\+Init}} (void)
\begin{DoxyCompactList}\small\item\em Initializes SPI1. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{drv__spi_8h_ab223a09c3d0c71db42a9a8bbe2e388be}{spi\+Read\+Bytes}} (uint8\+\_\+t reg, uint8\+\_\+t $\ast$p\+Data, uint8\+\_\+t size)
\begin{DoxyCompactList}\small\item\em Reads multiple bytes of data in. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{drv__spi_8h_a7d61fb36806c4e37a2bf675ba2d62008}{spi\+Write\+Bytes}} (uint8\+\_\+t $\ast$p\+Data, uint8\+\_\+t size)
\begin{DoxyCompactList}\small\item\em Writes multiple bytes of data in. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{drv__spi_8h_a3573b135702ff18ce4852e27547c4968}{spi\+Read\+One\+Byte}} (uint8\+\_\+t reg, uint8\+\_\+t $\ast$p\+Data)
\begin{DoxyCompactList}\small\item\em Reads one byte of data in. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{drv__spi_8h_aebb1dda4e95fbaba094d5beb79073279}{spi\+Write\+One\+Byte}} (uint8\+\_\+t reg, uint8\+\_\+t data)
\begin{DoxyCompactList}\small\item\em Writes one byte of data. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{drv__spi_8h_aaf6ce196dde98712e1223b99766e06c0}{DMA2\+\_\+\+Stream0\+\_\+\+IRQHandler}} (void)
\begin{DoxyCompactList}\small\item\em This function handles DMA2 stream1 global interrupt. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{drv__spi_8h_a877135f6494d6923d6f6ec32d75d9eeb}{DMA2\+\_\+\+Stream3\+\_\+\+IRQHandler}} (void)
\begin{DoxyCompactList}\small\item\em This function handles DMA2 stream3 global interrupt. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This file initializes the SPI peripheral as well as writes and reads to another device over SPI. 

Still needs to implement SPI2 for OSD chip Find a way to reuse write and read functions for SPI1 and SPI2

\begin{DoxyAuthor}{Author}
Jeremy Wolfe 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
23 FEB 2022 
\end{DoxyDate}


Definition in file \mbox{\hyperlink{drv__spi_8h_source}{drv\+\_\+spi.\+h}}.



\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{drv__spi_8h_af64f6dca6126f4fb9299c912c7f8ad81}\label{drv__spi_8h_af64f6dca6126f4fb9299c912c7f8ad81}} 
\index{drv\_spi.h@{drv\_spi.h}!SPI1\_DISABLE@{SPI1\_DISABLE}}
\index{SPI1\_DISABLE@{SPI1\_DISABLE}!drv\_spi.h@{drv\_spi.h}}
\doxysubsubsection{\texorpdfstring{SPI1\_DISABLE}{SPI1\_DISABLE}}
{\footnotesize\ttfamily \#define SPI1\+\_\+\+DISABLE~GPIOA-\/$>$BSRR $\vert$= GPIO\+\_\+\+BSRR\+\_\+\+BS4}



Definition at line \mbox{\hyperlink{drv__spi_8h_source_l00018}{18}} of file \mbox{\hyperlink{drv__spi_8h_source}{drv\+\_\+spi.\+h}}.

\mbox{\Hypertarget{drv__spi_8h_a969f555816dfb8f48a85c1795ff5e63d}\label{drv__spi_8h_a969f555816dfb8f48a85c1795ff5e63d}} 
\index{drv\_spi.h@{drv\_spi.h}!SPI1\_ENABLE@{SPI1\_ENABLE}}
\index{SPI1\_ENABLE@{SPI1\_ENABLE}!drv\_spi.h@{drv\_spi.h}}
\doxysubsubsection{\texorpdfstring{SPI1\_ENABLE}{SPI1\_ENABLE}}
{\footnotesize\ttfamily \#define SPI1\+\_\+\+ENABLE~GPIOA-\/$>$BSRR $\vert$= GPIO\+\_\+\+BSRR\+\_\+\+BR4}



Definition at line \mbox{\hyperlink{drv__spi_8h_source_l00017}{17}} of file \mbox{\hyperlink{drv__spi_8h_source}{drv\+\_\+spi.\+h}}.

\mbox{\Hypertarget{drv__spi_8h_a1e6f0af65653e4941210f2ebf6e96df6}\label{drv__spi_8h_a1e6f0af65653e4941210f2ebf6e96df6}} 
\index{drv\_spi.h@{drv\_spi.h}!SPI\_BR\_PRESCALER\_128@{SPI\_BR\_PRESCALER\_128}}
\index{SPI\_BR\_PRESCALER\_128@{SPI\_BR\_PRESCALER\_128}!drv\_spi.h@{drv\_spi.h}}
\doxysubsubsection{\texorpdfstring{SPI\_BR\_PRESCALER\_128}{SPI\_BR\_PRESCALER\_128}}
{\footnotesize\ttfamily \#define SPI\+\_\+\+BR\+\_\+\+PRESCALER\+\_\+128~(0x6 $<$$<$ 3U)}



Definition at line \mbox{\hyperlink{drv__spi_8h_source_l00021}{21}} of file \mbox{\hyperlink{drv__spi_8h_source}{drv\+\_\+spi.\+h}}.

\mbox{\Hypertarget{drv__spi_8h_ad0b1b31708f069aa075fe2f2b899babf}\label{drv__spi_8h_ad0b1b31708f069aa075fe2f2b899babf}} 
\index{drv\_spi.h@{drv\_spi.h}!SPI\_BR\_PRESCALER\_16@{SPI\_BR\_PRESCALER\_16}}
\index{SPI\_BR\_PRESCALER\_16@{SPI\_BR\_PRESCALER\_16}!drv\_spi.h@{drv\_spi.h}}
\doxysubsubsection{\texorpdfstring{SPI\_BR\_PRESCALER\_16}{SPI\_BR\_PRESCALER\_16}}
{\footnotesize\ttfamily \#define SPI\+\_\+\+BR\+\_\+\+PRESCALER\+\_\+16~(0x3 $<$$<$ 3U)}



Definition at line \mbox{\hyperlink{drv__spi_8h_source_l00020}{20}} of file \mbox{\hyperlink{drv__spi_8h_source}{drv\+\_\+spi.\+h}}.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{drv__spi_8h_aaf6ce196dde98712e1223b99766e06c0}\label{drv__spi_8h_aaf6ce196dde98712e1223b99766e06c0}} 
\index{drv\_spi.h@{drv\_spi.h}!DMA2\_Stream0\_IRQHandler@{DMA2\_Stream0\_IRQHandler}}
\index{DMA2\_Stream0\_IRQHandler@{DMA2\_Stream0\_IRQHandler}!drv\_spi.h@{drv\_spi.h}}
\doxysubsubsection{\texorpdfstring{DMA2\_Stream0\_IRQHandler()}{DMA2\_Stream0\_IRQHandler()}}
{\footnotesize\ttfamily void DMA2\+\_\+\+Stream0\+\_\+\+IRQHandler (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



This function handles DMA2 stream1 global interrupt. 



Definition at line \mbox{\hyperlink{drv__spi_8c_source_l00298}{298}} of file \mbox{\hyperlink{drv__spi_8c_source}{drv\+\_\+spi.\+c}}.

\mbox{\Hypertarget{drv__spi_8h_a877135f6494d6923d6f6ec32d75d9eeb}\label{drv__spi_8h_a877135f6494d6923d6f6ec32d75d9eeb}} 
\index{drv\_spi.h@{drv\_spi.h}!DMA2\_Stream3\_IRQHandler@{DMA2\_Stream3\_IRQHandler}}
\index{DMA2\_Stream3\_IRQHandler@{DMA2\_Stream3\_IRQHandler}!drv\_spi.h@{drv\_spi.h}}
\doxysubsubsection{\texorpdfstring{DMA2\_Stream3\_IRQHandler()}{DMA2\_Stream3\_IRQHandler()}}
{\footnotesize\ttfamily void DMA2\+\_\+\+Stream3\+\_\+\+IRQHandler (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



This function handles DMA2 stream3 global interrupt. 



Definition at line \mbox{\hyperlink{drv__spi_8c_source_l00320}{320}} of file \mbox{\hyperlink{drv__spi_8c_source}{drv\+\_\+spi.\+c}}.

\mbox{\Hypertarget{drv__spi_8h_afdbacf07d926a145cc4d681c38980d03}\label{drv__spi_8h_afdbacf07d926a145cc4d681c38980d03}} 
\index{drv\_spi.h@{drv\_spi.h}!spi1Init@{spi1Init}}
\index{spi1Init@{spi1Init}!drv\_spi.h@{drv\_spi.h}}
\doxysubsubsection{\texorpdfstring{spi1Init()}{spi1Init()}}
{\footnotesize\ttfamily void spi1\+Init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Initializes SPI1. 

\begin{DoxyReturn}{Returns}
Void. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{drv__spi_8c_source_l00021}{21}} of file \mbox{\hyperlink{drv__spi_8c_source}{drv\+\_\+spi.\+c}}.

\mbox{\Hypertarget{drv__spi_8h_ab223a09c3d0c71db42a9a8bbe2e388be}\label{drv__spi_8h_ab223a09c3d0c71db42a9a8bbe2e388be}} 
\index{drv\_spi.h@{drv\_spi.h}!spiReadBytes@{spiReadBytes}}
\index{spiReadBytes@{spiReadBytes}!drv\_spi.h@{drv\_spi.h}}
\doxysubsubsection{\texorpdfstring{spiReadBytes()}{spiReadBytes()}}
{\footnotesize\ttfamily void spi\+Read\+Bytes (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{reg,  }\item[{uint8\+\_\+t $\ast$}]{p\+Data,  }\item[{uint8\+\_\+t}]{size }\end{DoxyParamCaption})}



Reads multiple bytes of data in. 


\begin{DoxyParams}{Parameters}
{\em reg} & The hex value of the first register to read from. \\
\hline
{\em $\ast$p\+Data} & A pointer to location where you want to read data to. \\
\hline
{\em size} & The amount of bytes to be read. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Void. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{drv__spi_8c_source_l00154}{154}} of file \mbox{\hyperlink{drv__spi_8c_source}{drv\+\_\+spi.\+c}}.

\mbox{\Hypertarget{drv__spi_8h_a3573b135702ff18ce4852e27547c4968}\label{drv__spi_8h_a3573b135702ff18ce4852e27547c4968}} 
\index{drv\_spi.h@{drv\_spi.h}!spiReadOneByte@{spiReadOneByte}}
\index{spiReadOneByte@{spiReadOneByte}!drv\_spi.h@{drv\_spi.h}}
\doxysubsubsection{\texorpdfstring{spiReadOneByte()}{spiReadOneByte()}}
{\footnotesize\ttfamily void spi\+Read\+One\+Byte (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{reg,  }\item[{uint8\+\_\+t $\ast$}]{p\+Data }\end{DoxyParamCaption})}



Reads one byte of data in. 


\begin{DoxyParams}{Parameters}
{\em reg} & The hex value of the register to read from. \\
\hline
{\em $\ast$p\+Data} & A pointer to location where you want to read data to. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Void. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{drv__spi_8c_source_l00227}{227}} of file \mbox{\hyperlink{drv__spi_8c_source}{drv\+\_\+spi.\+c}}.

\mbox{\Hypertarget{drv__spi_8h_a7d61fb36806c4e37a2bf675ba2d62008}\label{drv__spi_8h_a7d61fb36806c4e37a2bf675ba2d62008}} 
\index{drv\_spi.h@{drv\_spi.h}!spiWriteBytes@{spiWriteBytes}}
\index{spiWriteBytes@{spiWriteBytes}!drv\_spi.h@{drv\_spi.h}}
\doxysubsubsection{\texorpdfstring{spiWriteBytes()}{spiWriteBytes()}}
{\footnotesize\ttfamily void spi\+Write\+Bytes (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{p\+Data,  }\item[{uint8\+\_\+t}]{size }\end{DoxyParamCaption})}



Writes multiple bytes of data in. 


\begin{DoxyParams}{Parameters}
{\em reg} & The hex value of the register to write to. \\
\hline
{\em $\ast$p\+Data} & A pointer to the data you want to write. \\
\hline
{\em size} & The amount of bytes to write. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Void. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{drv__spi_8c_source_l00189}{189}} of file \mbox{\hyperlink{drv__spi_8c_source}{drv\+\_\+spi.\+c}}.

\mbox{\Hypertarget{drv__spi_8h_aebb1dda4e95fbaba094d5beb79073279}\label{drv__spi_8h_aebb1dda4e95fbaba094d5beb79073279}} 
\index{drv\_spi.h@{drv\_spi.h}!spiWriteOneByte@{spiWriteOneByte}}
\index{spiWriteOneByte@{spiWriteOneByte}!drv\_spi.h@{drv\_spi.h}}
\doxysubsubsection{\texorpdfstring{spiWriteOneByte()}{spiWriteOneByte()}}
{\footnotesize\ttfamily void spi\+Write\+One\+Byte (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{reg,  }\item[{uint8\+\_\+t}]{data }\end{DoxyParamCaption})}



Writes one byte of data. 


\begin{DoxyParams}{Parameters}
{\em reg} & The hex value of the register to write to. \\
\hline
{\em data} & The data to write. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Void. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{drv__spi_8c_source_l00261}{261}} of file \mbox{\hyperlink{drv__spi_8c_source}{drv\+\_\+spi.\+c}}.

